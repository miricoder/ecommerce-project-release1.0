{"ast":null,"code":"\"use strict\";\n\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\n\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\n\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\n\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\n\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\n\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\n\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/json/stringify\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _client = require(\"../client\");\n\nvar _actionParser = require(\"./actionParser\");\n\nvar _makeIdxState = _interopRequireDefault(require(\"./makeIdxState\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n\n    if (enumerableOnly) symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      var _context2;\n\n      _forEachInstanceProperty(_context2 = ownKeys(Object(source), true)).call(_context2, function (key) {\n        (0, _defineProperty2.default)(target, key, source[key]);\n      });\n    } else if (_Object$getOwnPropertyDescriptors) {\n      _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source));\n    } else {\n      var _context3;\n\n      _forEachInstanceProperty(_context3 = ownKeys(Object(source))).call(_context3, function (key) {\n        _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar generateDirectFetch = function generateDirectFetch(_ref) {\n  var actionDefinition = _ref.actionDefinition,\n      _ref$defaultParamsFor = _ref.defaultParamsForAction,\n      defaultParamsForAction = _ref$defaultParamsFor === void 0 ? {} : _ref$defaultParamsFor,\n      _ref$immutableParamsF = _ref.immutableParamsForAction,\n      immutableParamsForAction = _ref$immutableParamsF === void 0 ? {} : _ref$immutableParamsF,\n      toPersist = _ref.toPersist;\n  var target = actionDefinition.href;\n  return /*#__PURE__*/function () {\n    var _ref2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(params) {\n      var headers, body;\n      return _regenerator.default.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              headers = {\n                'content-type': 'application/json',\n                'accept': actionDefinition.accepts || 'application/ion+json'\n              };\n              body = (0, _stringify.default)(_objectSpread(_objectSpread(_objectSpread({}, defaultParamsForAction), params), immutableParamsForAction));\n              return _context.abrupt(\"return\", (0, _client.request)(target, {\n                method: actionDefinition.method,\n                headers: headers,\n                body: body\n              }).then(function (response) {\n                var respJson = response.json();\n\n                if (response.ok) {\n                  return respJson;\n                } else if (response.status === 401 && response.headers.get('WWW-Authenticate') === 'Oktadevicejwt realm=\"Okta Device\"') {\n                  // Okta server responds 401 status code with WWW-Authenticate header and new remediation\n                  // so that the iOS/MacOS credential SSO extension (Okta Verify) can intercept\n                  // the response reaches here when Okta Verify is not installed\n                  // we need to return an idx object so that\n                  // the SIW can proceed to the next step without showing error\n                  return respJson.then(function (err) {\n                    var ms = (0, _makeIdxState.default)(err, toPersist); // set to true if flow should be continued without showing any errors\n\n                    ms.stepUp = true;\n                    return _promise.default.reject(ms);\n                  });\n                }\n\n                return respJson.then(function (err) {\n                  return _promise.default.reject((0, _makeIdxState.default)(err, toPersist));\n                });\n              }).then(function (idxResponse) {\n                return (0, _makeIdxState.default)(idxResponse, toPersist);\n              }));\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n}; // TODO: Resolve in M2: Either build the final polling solution or remove this code\n// const generatePollingFetch = function generatePollingFetch( { actionDefinition, defaultParamsForAction = {}, immutableParamsForAction = {} } ) {\n//   // TODO: Discussions ongoing about when/how to terminate polling: OKTA-246581\n//   const target = actionDefinition.href;\n//   return async function(params) {\n//     return fetch(target, {\n//       method: actionDefinition.method,\n//       headers: {\n//         'content-type': actionDefinition.accepts,\n//       },\n//       body: JSON.stringify({ ...defaultParamsForAction, ...params, ...immutableParamsForAction })\n//     })\n//       .then( response => response.ok ? response.json() : response.json().then( err => Promise.reject(err)) )\n//       .then( idxResponse => makeIdxState(idxResponse) );\n//   };\n// };\n\n\nvar generateIdxAction = function generateIdxAction(actionDefinition, toPersist) {\n  // TODO: leaving this here to see where the polling is EXPECTED to drop into the code, but removing any accidental trigger of incomplete code\n  // const generator =  actionDefinition.refresh ? generatePollingFetch : generateDirectFetch;\n  var generator = generateDirectFetch;\n\n  var _divideActionParamsBy = (0, _actionParser.divideActionParamsByMutability)(actionDefinition),\n      defaultParams = _divideActionParamsBy.defaultParams,\n      neededParams = _divideActionParamsBy.neededParams,\n      immutableParams = _divideActionParamsBy.immutableParams;\n\n  var action = generator({\n    actionDefinition: actionDefinition,\n    defaultParamsForAction: defaultParams[actionDefinition.name],\n    immutableParamsForAction: immutableParams[actionDefinition.name],\n    toPersist: toPersist\n  });\n  action.neededParams = neededParams;\n  return action;\n};\n\nvar _default = generateIdxAction;\nexports.default = _default;","map":{"version":3,"sources":["/Users/miralimirzayev/Desktop/Spring/FULLStackDev_BOOT_CAMP/ecommerce-project-release1.0/03-frontend/angular-ecommerce/node_modules/@okta/okta-idx-js/src/v1/generateIdxAction.js"],"names":["_Object$keys","require","_Object$getOwnPropertySymbols","_filterInstanceProperty","_Object$getOwnPropertyDescriptor","_forEachInstanceProperty","_Object$getOwnPropertyDescriptors","_Object$defineProperties","_Object$defineProperty","_interopRequireDefault","exports","value","default","_regenerator","_stringify","_promise","_defineProperty2","_asyncToGenerator2","_client","_actionParser","_makeIdxState","ownKeys","object","enumerableOnly","keys","symbols","call","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","_context2","Object","key","_context3","generateDirectFetch","_ref","actionDefinition","_ref$defaultParamsFor","defaultParamsForAction","_ref$immutableParamsF","immutableParamsForAction","toPersist","href","_ref2","mark","_callee","params","headers","body","wrap","_callee$","_context","prev","next","accepts","abrupt","request","method","then","response","respJson","json","ok","status","get","err","ms","stepUp","reject","idxResponse","stop","_x","generateIdxAction","generator","_divideActionParamsBy","divideActionParamsByMutability","defaultParams","neededParams","immutableParams","action","name","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\n\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\n\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\n\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\n\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\n\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\n\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nrequire(\"core-js/modules/es.function.name.js\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/json/stringify\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _client = require(\"../client\");\n\nvar _actionParser = require(\"./actionParser\");\n\nvar _makeIdxState = _interopRequireDefault(require(\"./makeIdxState\"));\n\nfunction ownKeys(object, enumerableOnly) { var keys = _Object$keys(object); if (_Object$getOwnPropertySymbols) { var symbols = _Object$getOwnPropertySymbols(object); if (enumerableOnly) symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) { return _Object$getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { var _context2; _forEachInstanceProperty(_context2 = ownKeys(Object(source), true)).call(_context2, function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (_Object$getOwnPropertyDescriptors) { _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)); } else { var _context3; _forEachInstanceProperty(_context3 = ownKeys(Object(source))).call(_context3, function (key) { _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar generateDirectFetch = function generateDirectFetch(_ref) {\n  var actionDefinition = _ref.actionDefinition,\n      _ref$defaultParamsFor = _ref.defaultParamsForAction,\n      defaultParamsForAction = _ref$defaultParamsFor === void 0 ? {} : _ref$defaultParamsFor,\n      _ref$immutableParamsF = _ref.immutableParamsForAction,\n      immutableParamsForAction = _ref$immutableParamsF === void 0 ? {} : _ref$immutableParamsF,\n      toPersist = _ref.toPersist;\n  var target = actionDefinition.href;\n  return /*#__PURE__*/function () {\n    var _ref2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(params) {\n      var headers, body;\n      return _regenerator.default.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              headers = {\n                'content-type': 'application/json',\n                'accept': actionDefinition.accepts || 'application/ion+json'\n              };\n              body = (0, _stringify.default)(_objectSpread(_objectSpread(_objectSpread({}, defaultParamsForAction), params), immutableParamsForAction));\n              return _context.abrupt(\"return\", (0, _client.request)(target, {\n                method: actionDefinition.method,\n                headers: headers,\n                body: body\n              }).then(function (response) {\n                var respJson = response.json();\n\n                if (response.ok) {\n                  return respJson;\n                } else if (response.status === 401 && response.headers.get('WWW-Authenticate') === 'Oktadevicejwt realm=\"Okta Device\"') {\n                  // Okta server responds 401 status code with WWW-Authenticate header and new remediation\n                  // so that the iOS/MacOS credential SSO extension (Okta Verify) can intercept\n                  // the response reaches here when Okta Verify is not installed\n                  // we need to return an idx object so that\n                  // the SIW can proceed to the next step without showing error\n                  return respJson.then(function (err) {\n                    var ms = (0, _makeIdxState.default)(err, toPersist); // set to true if flow should be continued without showing any errors\n\n                    ms.stepUp = true;\n                    return _promise.default.reject(ms);\n                  });\n                }\n\n                return respJson.then(function (err) {\n                  return _promise.default.reject((0, _makeIdxState.default)(err, toPersist));\n                });\n              }).then(function (idxResponse) {\n                return (0, _makeIdxState.default)(idxResponse, toPersist);\n              }));\n\n            case 3:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n}; // TODO: Resolve in M2: Either build the final polling solution or remove this code\n// const generatePollingFetch = function generatePollingFetch( { actionDefinition, defaultParamsForAction = {}, immutableParamsForAction = {} } ) {\n//   // TODO: Discussions ongoing about when/how to terminate polling: OKTA-246581\n//   const target = actionDefinition.href;\n//   return async function(params) {\n//     return fetch(target, {\n//       method: actionDefinition.method,\n//       headers: {\n//         'content-type': actionDefinition.accepts,\n//       },\n//       body: JSON.stringify({ ...defaultParamsForAction, ...params, ...immutableParamsForAction })\n//     })\n//       .then( response => response.ok ? response.json() : response.json().then( err => Promise.reject(err)) )\n//       .then( idxResponse => makeIdxState(idxResponse) );\n//   };\n// };\n\n\nvar generateIdxAction = function generateIdxAction(actionDefinition, toPersist) {\n  // TODO: leaving this here to see where the polling is EXPECTED to drop into the code, but removing any accidental trigger of incomplete code\n  // const generator =  actionDefinition.refresh ? generatePollingFetch : generateDirectFetch;\n  var generator = generateDirectFetch;\n\n  var _divideActionParamsBy = (0, _actionParser.divideActionParamsByMutability)(actionDefinition),\n      defaultParams = _divideActionParamsBy.defaultParams,\n      neededParams = _divideActionParamsBy.neededParams,\n      immutableParams = _divideActionParamsBy.immutableParams;\n\n  var action = generator({\n    actionDefinition: actionDefinition,\n    defaultParamsForAction: defaultParams[actionDefinition.name],\n    immutableParamsForAction: immutableParams[actionDefinition.name],\n    toPersist: toPersist\n  });\n  action.neededParams = neededParams;\n  return action;\n};\n\nvar _default = generateIdxAction;\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}