{"ast":null,"code":"\"use strict\";\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _url = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/url\"));\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _introspect = _interopRequireDefault(require(\"./introspect\"));\n\nvar _bootstrap = _interopRequireDefault(require(\"./bootstrap\"));\n\nvar _parsers = _interopRequireDefault(require(\"./parsers\"));\n\nvar _client = require(\"./client\");\n/*!\n * Copyright (c) 2021-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\n\n\nvar LATEST_SUPPORTED_IDX_API_VERSION = '1.0.0';\n\nvar start = /*#__PURE__*/function () {\n  var _start = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(_ref) {\n    var _issuer, _issuer2;\n\n    var clientId, domain, issuer, stateHandle, interactionHandle, version, redirectUri, state, scopes, codeChallenge, codeChallengeMethod, stateTokenExternalId, baseUrl, toPersist, cleanVersion, bootstrapParams, interaction_handle, _parsersForVersion, _makeIdxState, idxResponse, idxState;\n\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            clientId = _ref.clientId, domain = _ref.domain, issuer = _ref.issuer, stateHandle = _ref.stateHandle, interactionHandle = _ref.interactionHandle, version = _ref.version, redirectUri = _ref.redirectUri, state = _ref.state, scopes = _ref.scopes, codeChallenge = _ref.codeChallenge, codeChallengeMethod = _ref.codeChallengeMethod, stateTokenExternalId = _ref.stateTokenExternalId;\n            issuer = (_issuer = issuer) === null || _issuer === void 0 ? void 0 : _issuer.replace(/\\/+$/, '');\n            baseUrl = ((_issuer2 = issuer) === null || _issuer2 === void 0 ? void 0 : (0, _indexOf.default)(_issuer2).call(_issuer2, '/oauth2')) > 0 ? issuer : issuer + '/oauth2'; // org AS uses domain as AS, but we need the base url for calls\n\n            toPersist = {\n              baseUrl: baseUrl,\n              clientId: clientId,\n              state: state\n            };\n\n            if (!(!domain && !issuer)) {\n              _context.next = 6;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'issuer is required'\n            }));\n\n          case 6:\n            if (!(!stateHandle && !clientId)) {\n              _context.next = 8;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'clientId is required'\n            }));\n\n          case 8:\n            if (!(!stateHandle && !redirectUri)) {\n              _context.next = 10;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'redirectUri is required'\n            }));\n\n          case 10:\n            if (!(!stateHandle && !(codeChallenge && codeChallengeMethod))) {\n              _context.next = 12;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'PKCE params (codeChallenge, codeChallengeMethod) are required'\n            }));\n\n          case 12:\n            if (!domain) {\n              domain = new _url.default(issuer).origin;\n            }\n\n            if (version) {\n              _context.next = 15;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'version is required'\n            }));\n\n          case 15:\n            cleanVersion = (version !== null && version !== void 0 ? version : '').replace(/[^0-9a-zA-Z._-]/, '');\n\n            if (!(cleanVersion !== version || !version)) {\n              _context.next = 18;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'invalid version supplied - version is required and uses semver syntax'\n            }));\n\n          case 18:\n            if (!(!stateHandle && !interactionHandle)) {\n              _context.next = 31;\n              break;\n            }\n\n            _context.prev = 19;\n            bootstrapParams = {\n              clientId: clientId,\n              baseUrl: baseUrl,\n              scopes: scopes,\n              redirectUri: redirectUri,\n              codeChallenge: codeChallenge,\n              codeChallengeMethod: codeChallengeMethod,\n              state: state\n            };\n            _context.next = 23;\n            return (0, _bootstrap.default)(bootstrapParams);\n\n          case 23:\n            interaction_handle = _context.sent;\n            interactionHandle = interaction_handle;\n            toPersist.interactionHandle = interactionHandle;\n            _context.next = 31;\n            break;\n\n          case 28:\n            _context.prev = 28;\n            _context.t0 = _context[\"catch\"](19);\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: _context.t0\n            }));\n\n          case 31:\n            _context.prev = 31;\n            _parsersForVersion = (0, _parsers.default)(version), _makeIdxState = _parsersForVersion.makeIdxState;\n            _context.next = 35;\n            return (0, _introspect.default)({\n              domain: domain,\n              interactionHandle: interactionHandle,\n              stateHandle: stateHandle,\n              version: version,\n              stateTokenExternalId: stateTokenExternalId\n            }).catch(function (err) {\n              return _promise.default.reject({\n                error: 'introspect call failed',\n                // Transform all errors into an IdX State object.\n                // This allows IdX based errors (messages) to optionally proceed with remediation forms\n                details: _makeIdxState(err, toPersist)\n              });\n            });\n\n          case 35:\n            idxResponse = _context.sent;\n            idxState = _makeIdxState(idxResponse, toPersist);\n            return _context.abrupt(\"return\", idxState);\n\n          case 40:\n            _context.prev = 40;\n            _context.t1 = _context[\"catch\"](31);\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: _context.t1\n            }));\n\n          case 43:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[19, 28], [31, 40]]);\n  }));\n\n  function start(_x) {\n    return _start.apply(this, arguments);\n  }\n\n  return start;\n}();\n\nvar _parsersForVersion2 = (0, _parsers.default)(LATEST_SUPPORTED_IDX_API_VERSION),\n    makeIdxState = _parsersForVersion2.makeIdxState;\n\nvar _default = {\n  start: start,\n  introspect: _introspect.default,\n  interact: _bootstrap.default,\n  makeIdxState: makeIdxState,\n  client: _client.HttpClient,\n  LATEST_SUPPORTED_IDX_API_VERSION: LATEST_SUPPORTED_IDX_API_VERSION\n};\nexports.default = _default;","map":{"version":3,"sources":["/Users/miralimirzayev/Desktop/Spring/FULLStackDev_BOOT_CAMP/ecommerce-project-release1.0/03-frontend/angular-ecommerce/node_modules/@okta/okta-idx-js/src/index.js"],"names":["_Object$defineProperty","require","_interopRequireDefault","exports","value","default","_regenerator","_indexOf","_promise","_url","_asyncToGenerator2","_introspect","_bootstrap","_parsers","_client","LATEST_SUPPORTED_IDX_API_VERSION","start","_start","mark","_callee","_ref","_issuer","_issuer2","clientId","domain","issuer","stateHandle","interactionHandle","version","redirectUri","state","scopes","codeChallenge","codeChallengeMethod","stateTokenExternalId","baseUrl","toPersist","cleanVersion","bootstrapParams","interaction_handle","_parsersForVersion","_makeIdxState","idxResponse","idxState","wrap","_callee$","_context","prev","next","replace","call","abrupt","reject","error","origin","sent","t0","makeIdxState","catch","err","details","t1","stop","_x","apply","arguments","_parsersForVersion2","_default","introspect","interact","client","HttpClient"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _url = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/url\"));\n\nrequire(\"core-js/modules/es.string.replace.js\");\n\nrequire(\"core-js/modules/es.regexp.exec.js\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _introspect = _interopRequireDefault(require(\"./introspect\"));\n\nvar _bootstrap = _interopRequireDefault(require(\"./bootstrap\"));\n\nvar _parsers = _interopRequireDefault(require(\"./parsers\"));\n\nvar _client = require(\"./client\");\n\n/*!\n * Copyright (c) 2021-Present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nvar LATEST_SUPPORTED_IDX_API_VERSION = '1.0.0';\n\nvar start = /*#__PURE__*/function () {\n  var _start = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(_ref) {\n    var _issuer, _issuer2;\n\n    var clientId, domain, issuer, stateHandle, interactionHandle, version, redirectUri, state, scopes, codeChallenge, codeChallengeMethod, stateTokenExternalId, baseUrl, toPersist, cleanVersion, bootstrapParams, interaction_handle, _parsersForVersion, _makeIdxState, idxResponse, idxState;\n\n    return _regenerator.default.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            clientId = _ref.clientId, domain = _ref.domain, issuer = _ref.issuer, stateHandle = _ref.stateHandle, interactionHandle = _ref.interactionHandle, version = _ref.version, redirectUri = _ref.redirectUri, state = _ref.state, scopes = _ref.scopes, codeChallenge = _ref.codeChallenge, codeChallengeMethod = _ref.codeChallengeMethod, stateTokenExternalId = _ref.stateTokenExternalId;\n            issuer = (_issuer = issuer) === null || _issuer === void 0 ? void 0 : _issuer.replace(/\\/+$/, '');\n            baseUrl = ((_issuer2 = issuer) === null || _issuer2 === void 0 ? void 0 : (0, _indexOf.default)(_issuer2).call(_issuer2, '/oauth2')) > 0 ? issuer : issuer + '/oauth2'; // org AS uses domain as AS, but we need the base url for calls\n\n            toPersist = {\n              baseUrl: baseUrl,\n              clientId: clientId,\n              state: state\n            };\n\n            if (!(!domain && !issuer)) {\n              _context.next = 6;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'issuer is required'\n            }));\n\n          case 6:\n            if (!(!stateHandle && !clientId)) {\n              _context.next = 8;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'clientId is required'\n            }));\n\n          case 8:\n            if (!(!stateHandle && !redirectUri)) {\n              _context.next = 10;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'redirectUri is required'\n            }));\n\n          case 10:\n            if (!(!stateHandle && !(codeChallenge && codeChallengeMethod))) {\n              _context.next = 12;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'PKCE params (codeChallenge, codeChallengeMethod) are required'\n            }));\n\n          case 12:\n            if (!domain) {\n              domain = new _url.default(issuer).origin;\n            }\n\n            if (version) {\n              _context.next = 15;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'version is required'\n            }));\n\n          case 15:\n            cleanVersion = (version !== null && version !== void 0 ? version : '').replace(/[^0-9a-zA-Z._-]/, '');\n\n            if (!(cleanVersion !== version || !version)) {\n              _context.next = 18;\n              break;\n            }\n\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: 'invalid version supplied - version is required and uses semver syntax'\n            }));\n\n          case 18:\n            if (!(!stateHandle && !interactionHandle)) {\n              _context.next = 31;\n              break;\n            }\n\n            _context.prev = 19;\n            bootstrapParams = {\n              clientId: clientId,\n              baseUrl: baseUrl,\n              scopes: scopes,\n              redirectUri: redirectUri,\n              codeChallenge: codeChallenge,\n              codeChallengeMethod: codeChallengeMethod,\n              state: state\n            };\n            _context.next = 23;\n            return (0, _bootstrap.default)(bootstrapParams);\n\n          case 23:\n            interaction_handle = _context.sent;\n            interactionHandle = interaction_handle;\n            toPersist.interactionHandle = interactionHandle;\n            _context.next = 31;\n            break;\n\n          case 28:\n            _context.prev = 28;\n            _context.t0 = _context[\"catch\"](19);\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: _context.t0\n            }));\n\n          case 31:\n            _context.prev = 31;\n            _parsersForVersion = (0, _parsers.default)(version), _makeIdxState = _parsersForVersion.makeIdxState;\n            _context.next = 35;\n            return (0, _introspect.default)({\n              domain: domain,\n              interactionHandle: interactionHandle,\n              stateHandle: stateHandle,\n              version: version,\n              stateTokenExternalId: stateTokenExternalId\n            }).catch(function (err) {\n              return _promise.default.reject({\n                error: 'introspect call failed',\n                // Transform all errors into an IdX State object.\n                // This allows IdX based errors (messages) to optionally proceed with remediation forms\n                details: _makeIdxState(err, toPersist)\n              });\n            });\n\n          case 35:\n            idxResponse = _context.sent;\n            idxState = _makeIdxState(idxResponse, toPersist);\n            return _context.abrupt(\"return\", idxState);\n\n          case 40:\n            _context.prev = 40;\n            _context.t1 = _context[\"catch\"](31);\n            return _context.abrupt(\"return\", _promise.default.reject({\n              error: _context.t1\n            }));\n\n          case 43:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[19, 28], [31, 40]]);\n  }));\n\n  function start(_x) {\n    return _start.apply(this, arguments);\n  }\n\n  return start;\n}();\n\nvar _parsersForVersion2 = (0, _parsers.default)(LATEST_SUPPORTED_IDX_API_VERSION),\n    makeIdxState = _parsersForVersion2.makeIdxState;\n\nvar _default = {\n  start: start,\n  introspect: _introspect.default,\n  interact: _bootstrap.default,\n  makeIdxState: makeIdxState,\n  client: _client.HttpClient,\n  LATEST_SUPPORTED_IDX_API_VERSION: LATEST_SUPPORTED_IDX_API_VERSION\n};\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}